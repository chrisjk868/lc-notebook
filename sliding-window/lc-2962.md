# 2962. Count Subarrays Where Max Element Appears at Least K Times
***Topics***: *Sliding Window, Array*  
***Difficulty***: <span style="color: #fac31d;">Medium</span>
<!-- green: #46c6c2, yellow: #fac31d, red: #f8615c-->
---
You are given an integer array `nums` and a positive integer `k`.

Return the number of subarrays where the maximum element of `nums` appears at least `k` times in that subarray.

A **subarray** is a contiguous sequence of elements within an array.

---
**Example 1:**  

Input: `nums = [1,3,2,3,3], k = 2`  
Output: `6`  
Explanation: `The subarrays that contain the element 3 at least 2 times are: [1,3,2,3], [1,3,2,3,3], [3,2,3], [3,2,3,3], [2,3,3] and [3,3].`  

---
## Intuition
[intuition]

---
## Implementation
[implementation]

---
## Solution
```python
def countSubarrays(self, nums: List[int], k: int) -> int:
    # Sliding Window
    l = 0
    ans, cnt, idx = 0, 0, 0
    max_n = max(nums)
    for r in range(len(nums)):
        if nums[r] == max_n:
            cnt += 1
        while l <= r and cnt >= k:
            if nums[l] == max_n:
                cnt -= 1
            l += 1
        # At this point we know that the current window has exactly k - 1 max_n for nums[l:r]
        # So we know that for nums[:l-1] the window has k or more of max_n
        # This means that all subarrays from [0->l:r] has k or more of max_n
        ans += l
    return ans
```
---
## Runtime & Space Complexity
$N$ ~ being the size of input array `nums`.  

Runtime Complexity:  
$\mathcal{O}(N)$

[explanation]

Space Complexity:  
$\mathcal{O}(1)$

[explanation]

---
## Code Performance
![2962 code performance](../y_resources/code-performances/lc-2962.png)

---